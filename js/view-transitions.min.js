class ViewTransitionManager{constructor(t={}){this.options={duration:300,debug:!1,defaultType:"slide",excludeSelectors:['a[target="_blank"]','a[href^="http"]','a[href^="mailto:"]','a[href^="tel:"]',"a[download]",".no-transition"],enableBackForward:!0,...t},this.isSupported=this.checkSupport(),this.currentTransition=null,this.transitionHistory=[],this.init()}checkSupport(){return"startViewTransition"in document}init(){this.options.debug&&console.log("View Transitions API supported:",this.isSupported),this.interceptNavigation(),this.options.enableBackForward&&this.handlePopState(),this.addTransitionClasses()}addTransitionClasses(){this.isSupported?document.documentElement.classList.add("view-transitions-supported"):document.documentElement.classList.add("view-transitions-not-supported")}interceptNavigation(){document.addEventListener("click",t=>{const i=t.target.closest("a");if(!this.shouldTransition(i))return;t.preventDefault();const e=i.href,n=i.dataset.transitionType||this.options.defaultType;this.navigateWithTransition(e,n)})}shouldTransition(t){if(!t||!t.href)return!1;for(const i of this.options.excludeSelectors)if(t.matches(i))return!1;const i=new URL(t.href),e=new URL(window.location.href);return i.origin===e.origin}async navigateWithTransition(t,i="slide"){if(this.isSupported)try{document.documentElement.dataset.transitionType=i;const e=document.startViewTransition(async()=>{const e=await fetch(t),n=await e.text(),o=(new DOMParser).parseFromString(n,"text/html");this.updatePage(o),window.history.pushState({url:t,transitionType:i},"",t),this.transitionHistory.push({from:window.location.pathname,to:t,type:i,timestamp:Date.now()})});this.currentTransition=e,await e.finished,delete document.documentElement.dataset.transitionType,this.currentTransition=null,this.options.debug&&console.log("Transition completed:",t)}catch(i){console.error("View transition failed:",i),window.location.href=t}else window.location.href=t}updatePage(t){document.title=t.title,this.updateMetaTags(t);const i=t.querySelector("main"),e=document.querySelector("main");i&&e&&(e.innerHTML=i.innerHTML),document.body.className=t.body.className,this.reinitializeScripts(),window.scrollTo(0,0),document.dispatchEvent(new CustomEvent("pageTransitioned",{detail:{url:window.location.href}}))}updateMetaTags(t){["description","keywords","og:title","og:description","og:url","og:image","twitter:title","twitter:description","twitter:url"].forEach(i=>{const e=t.querySelector(`meta[name="${i}"], meta[property="${i}"]`),n=document.querySelector(`meta[name="${i}"], meta[property="${i}"]`);e&&n&&n.setAttribute("content",e.getAttribute("content"))});const i=t.querySelector('link[rel="canonical"]'),e=document.querySelector('link[rel="canonical"]');i&&e&&e.setAttribute("href",i.getAttribute("href"))}reinitializeScripts(){"function"==typeof window.highlightCurrentPage&&window.highlightCurrentPage(),"function"==typeof window.initMobileNav&&window.initMobileNav(),"function"==typeof initProgressiveImages&&initProgressiveImages(),document.dispatchEvent(new Event("DOMContentLoaded"))}handlePopState(){window.addEventListener("popstate",t=>{if(t.state&&t.state.url){const i=t.state.transitionType||"slide-reverse";this.navigateWithTransition(t.state.url,i)}}),window.history.replaceState({url:window.location.href,transitionType:this.options.defaultType},"",window.location.href)}skipTransition(){this.currentTransition&&this.currentTransition.skipTransition()}getStats(){return{isSupported:this.isSupported,transitionCount:this.transitionHistory.length,history:this.transitionHistory}}}function setViewTransitionName(t,i){t&&i&&(t.style.viewTransitionName=i)}let viewTransitionManager=null;function initViewTransitions(t={}){return viewTransitionManager||(viewTransitionManager=new ViewTransitionManager(t)),viewTransitionManager}document.addEventListener("DOMContentLoaded",()=>{const t=document.documentElement.dataset.viewTransitionsConfig;initViewTransitions(t?JSON.parse(t):{})}),"undefined"!=typeof module&&module.exports&&(module.exports={ViewTransitionManager:ViewTransitionManager,initViewTransitions:initViewTransitions,setViewTransitionName:setViewTransitionName}),window.ViewTransitionManager=ViewTransitionManager,window.initViewTransitions=initViewTransitions,window.setViewTransitionName=setViewTransitionName;